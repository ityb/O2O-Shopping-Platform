2018-03-24 14:03:38.358 [main] ERROR o.s.boot.SpringApplication -Application startup failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'jobConrtoller': Unsatisfied dependency expressed through field 'jobService'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.ityb.qugou.job.service.JobService': FactoryBean threw exception on object creation; nested exception is java.lang.IllegalStateException: Method batchUpdateStateJob not annotated with HTTP method type (ex. GET, POST)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:588)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:88)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1264)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:553)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:483)
	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:761)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:866)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:542)
	at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:122)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:737)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:370)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:314)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1162)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1151)
	at com.ityb.qugou.JobAppliction.main(JobAppliction.java:15)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'com.ityb.qugou.job.service.JobService': FactoryBean threw exception on object creation; nested exception is java.lang.IllegalStateException: Method batchUpdateStateJob not annotated with HTTP method type (ex. GET, POST)
	at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:175)
	at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.getObjectFromFactoryBean(FactoryBeanRegistrySupport.java:103)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectForBeanInstance(AbstractBeanFactory.java:1634)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:254)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:208)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1309)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1275)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1101)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1066)
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:585)
	... 19 common frames omitted
Caused by: java.lang.IllegalStateException: Method batchUpdateStateJob not annotated with HTTP method type (ex. GET, POST)
	at feign.Util.checkState(Util.java:128)
	at feign.Contract$BaseContract.parseAndValidateMetadata(Contract.java:97)
	at org.springframework.cloud.netflix.feign.support.SpringMvcContract.parseAndValidateMetadata(SpringMvcContract.java:133)
	at feign.Contract$BaseContract.parseAndValidatateMetadata(Contract.java:64)
	at feign.ReflectiveFeign$ParseHandlersByName.apply(ReflectiveFeign.java:146)
	at feign.ReflectiveFeign.newInstance(ReflectiveFeign.java:53)
	at feign.Feign$Builder.target(Feign.java:218)
	at org.springframework.cloud.netflix.feign.HystrixTargeter.target(HystrixTargeter.java:39)
	at org.springframework.cloud.netflix.feign.FeignClientFactoryBean.loadBalance(FeignClientFactoryBean.java:145)
	at org.springframework.cloud.netflix.feign.FeignClientFactoryBean.getObject(FeignClientFactoryBean.java:166)
	at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:168)
	... 29 common frames omitted
2018-03-24 14:06:56.409 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:00.010 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:05.011 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:10.010 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:15.009 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:20.012 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:25.008 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:30.026 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:35.007 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:40.009 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:45.011 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:50.012 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:07:55.011 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:08:00.007 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:08:05.012 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:08:10.016 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:08:15.013 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:08:20.009 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:08:25.005 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:08:30.011 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     DELIMITER ;;   CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    ;;   DELIMITER ;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER ;;
		CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_I' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:09:21.197 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:25.010 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:30.009 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:35.016 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:40.016 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:45.012 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:50.025 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:09:55.018 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:00.010 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:05.012 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:10.014 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:15.015 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:20.008 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:25.013 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:30.015 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:35.014 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 21 common frames omitted
2018-03-24 14:10:40.010 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:10:45.007 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:10:50.018 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:10:55.009 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
2018-03-24 14:11:00.009 [pool-8-thread-1] ERROR c.i.q.job.controller.JobConrtoller -batchUpdateStateJob....执行定时将今日购物车修改为历史购物车失败
org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
### The error may exist in file [D:\IT\qugou\project\qugou-parent\qugou-all-job\target\classes\mybatis\mapper\jobMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: DROP PROCEDURE IF EXISTS CART_NEW_H_LIST;     CREATE PROCEDURE CART_NEW_H_LIST()     BEGIN         DECLARE  S_ID VARCHAR(32) DEFAULT NULL;    DECLARE  B_NUMBER INT(9) DEFAULT 0;    DECLARE  IS_COUNT INT(9) DEFAULT 0;    DECLARE  M_TIME TIMESTAMP;       DECLARE FINISHED INT  DEFAULT 0;        DECLARE CART_NOW_LIST CURSOR FOR SELECT SPECIFICATION_ID,BUY_NUMBER,CTIME FROM T_P_CART WHERE DATE(NOW())>DATE(CTIME) AND CART_TYPE=1 AND ISVALID=1;    DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = 1;     OPEN  CART_NOW_LIST;            READ_LOOP:LOOP              FETCH CART_NOW_LIST INTO S_ID,B_NUMBER,M_TIME;      IF FINISHED=1 THEN                   LEAVE READ_LOOP;               END IF;       SELECT COUNT(*) FROM T_P_CART WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1 INTO IS_COUNT;      IF IS_COUNT=0 THEN        UPDATE T_P_CART SET CART_TYPE=2 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;      ELSE        UPDATE T_P_CART SET BUY_NUMBER=BUY_NUMBER+B_NUMBER,CTIME=M_TIME WHERE CART_TYPE=2 AND SPECIFICATION_ID=S_ID AND ISVALID=1;       UPDATE T_P_CART SET ISVALID=0 WHERE CART_TYPE=1 AND SPECIFICATION_ID=S_ID AND ISVALID=1;               END IF;       END LOOP;    CLOSE CART_NOW_LIST;   COMMIT;   END;    CALL CART_NEW_H_LIST();
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:399)
	at com.sun.proxy.$Proxy73.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:165)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:69)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:53)
	at com.sun.proxy.$Proxy97.batchUpdateStateJob(Unknown Source)
	at com.ityb.qugou.job.service.impl.JobServiceImpl.batchUpdateStateJob(JobServiceImpl.java:21)
	at com.ityb.qugou.job.controller.JobConrtoller.batchUpdateStateJob(JobConrtoller.java:34)
	at sun.reflect.GeneratedMethodAccessor49.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE PROCEDURE CART_NEW_H_LIST()  
		BEGIN  
		    DECLARE  S_ID VARCHAR(32) D' at line 2
	at sun.reflect.GeneratedConstructorAccessor67.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:408)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:425)
	at com.mysql.jdbc.Util.getInstance(Util.java:408)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:943)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3973)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3909)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2527)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2680)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2501)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1858)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1197)
	at com.mysql.jdbc.CallableStatement.execute(CallableStatement.java:823)
	at sun.reflect.GeneratedMethodAccessor52.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy126.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.CallableStatementHandler.query(CallableStatementHandler.java:66)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:78)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:303)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:154)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:102)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:82)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:120)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:113)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:73)
	at sun.reflect.GeneratedMethodAccessor50.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:386)
	... 20 common frames omitted
